global:
  argoNamespace: argocd          # where Application CRs live
  repoURL: https://github.com/tAIness/devops-project1.git
  rootPath: ""                   # repo root unless youâ€™re nesting
project:
  enabled: true
  name: default

apps:
  - name: backend
    path: infra/helm/backend
    destinationNamespace: mario-backend
    # (optional) helm values for the backend chart:
    values:
      ingress:
        enabled: true
        host: api.mario.local
        useRegex: false

      db:
        enabled: true
        storage:
          size: 1Gi
          storageClass: local-path   # you can omit if default class is local-path
        service:
          name: db
          port: 5432

  - name: web
    path: infra/helm/web
    destinationNamespace: mario-web
    # values:  # can omit because chart has defaults now
    #   ingress:
    #     enabled: true
    #     host: web.mario.local

    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

helmApps:
  - name: monitoring
    destinationNamespace: monitoring
    source:
      repoURL: https://prometheus-community.github.io/helm-charts
      chart: kube-prometheus-stack
      targetRevision: 62.3.0
    helm:
      skipCrds: true          # <= MUST be under 'helm'
      values: |                # <= all chart overrides go inside this block
      kubeEtcd: { enabled: false }
      kubeControllerManager: { enabled: false }
      kubeScheduler: { enabled: false }
      defaultRules:
    rules:
      etcd: false
      kubeControllerManager: false
      kubeScheduler: false

    grafana:
      admin:
        existingSecret: grafana-admin
        userKey: admin-user
        passwordKey: admin-password
    ingress:
        enabled: true
        ingressClassName: nginx
        hosts: [grafana.mario.local]
    service:
        type: ClusterIP

    prometheus:
      ingress:
        enabled: true
        ingressClassName: nginx
        hosts: [prometheus.mario.local]
    prometheusSpec:
        serviceMonitorSelectorNilUsesHelmValues: false
        podMonitorSelectorNilUsesHelmValues: false
        serviceMonitorNamespaceSelector: {}
        podMonitorNamespaceSelector: {}

    alertmanager:
        enabled: true
        ingress:
          enabled: true
          ingressClassName: nginx
          hosts: [alertmanager.mario.local]
    alertmanagerSpec:
       storage:
       volumeClaimTemplate:
       spec:
       storageClassName: local-path
       accessModes: ["ReadWriteOnce"]
       resources:
         requests:
         storage: 1Gi

secrets:
  - namespace: monitoring
    name: grafana-admin
    stringData:
      admin-user: admin
      admin-password: admin
